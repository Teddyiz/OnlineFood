<div class="row mt-3">
	<div class="col-md-4 order-md-2 mb-4">
	  <h4 class="d-flex justify-content-between align-items-center mb-3">
		<span class="text-muted">Your cart</span>
		<span class="badge badge-secondary badge-pill"><?php echo $cartItemCount;?></span>
	  </h4>
	  <ul class="list-group mb-3">
		<?php
			$total = 0;
			foreach($_SESSION['cart_items'] as $cartItem)
			{
				$total+=$cartItem['total_price'];
			?>
				<li class="list-group-item d-flex justify-content-between lh-condensed">
					<div>
						<h6 class="my-0"><?php echo $cartItem['product_name'] ?></h6>
						<small class="text-muted">Quantity: <?php echo $cartItem['qty'] ?> X Price: <?php echo $cartItem['product_price'] ?></small>
					</div>
					<span class="text-muted">$<?php echo $cartItem['total_price'] ?></span>
				</li>
		<?php
			}
		?>
	  
		<li class="list-group-item d-flex justify-content-between">
		  <span>Total (USD)</span>
		  <strong>$<?php echo number_format($total,2);?></strong>
		</li>
	  </ul>
	</div>
	<div class="col-md-8 order-md-1">
	  <h4 class="mb-3">Billing address</h4>
	  <?php
		if(isset($errorMsg) && count($errorMsg) > 0)
		{
			foreach($errorMsg as $error)
			{
				echo '<div class="alert alert-danger">'.$error.'</div>';
			}
		}
	  ?>
	  <form class="needs-validation" method="POST">
		<div class="row">
		  <div class="col-md-6 mb-3">
			<label for="firstName">First name</label>
			<input type="text" class="form-control" id="firstName" name="first_name" placeholder="First Name" value="<?php echo (isset($fnameValue) && !empty($fnameValue)) ? $fnameValue:'' ?>" >
		  </div>
		  <div class="col-md-6 mb-3">
			<label for="lastName">Last name</label>
			<input type="text" class="form-control" id="lastName" name="last_name" placeholder="Last Name" value="<?php echo (isset($lnameValue) && !empty($lnameValue)) ? $lnameValue:'' ?>" >
		  </div>
		</div>

		<div class="mb-3">
		  <label for="email">Email</label>
		  <input type="email" class="form-control" id="email" name="email" placeholder="you@example.com" value="<?php echo (isset($emailValue) && !empty($emailValue)) ? $emailValue:'' ?>">
		</div>

		<div class="mb-3">
		  <label for="address">Address</label>
		  <input type="text" class="form-control" id="address" name="address" placeholder="1234 Main St" value="<?php echo (isset($addressValue) && !empty($addressValue)) ? $addressValue:'' ?>">
		</div>

		<div class="mb-3">
		  <label for="address2">Address 2 <span class="text-muted">(Optional)</span></label>
		  <input type="text" class="form-control" id="address2" name="address2" placeholder="Apartment or suite" value="<?php echo (isset($address2Value) && !empty($address2Value)) ? $address2Value:'' ?>">
		</div>

		<div class="row">
		  <div class="col-md-5 mb-3">
			<label for="country">Country</label>
			<select class="custom-select d-block w-100" name="country" id="country" >
			  <option value="">Choose...</option>
			  <option value="United States" >United States</option>
			</select>
		  </div>
		  <div class="col-md-4 mb-3">
			<label for="state">State</label>
			<select class="custom-select d-block w-100" name="state" id="state" >
			  <option value="">Choose...</option>
			  <option value="California">California</option>
			</select>
		  </div>
		  <div class="col-md-3 mb-3">
			<label for="zip">Zip</label>
			<input type="text" class="form-control" id="zip" name="zipcode" placeholder="" value="<?php echo (isset($zipCodeValue) && !empty($zipCodeValue)) ? $zipCodeValue:'' ?>" >
		  </div>
		</div>
		<hr class="mb-4">

		<h4 class="mb-3">Payment</h4>

		<div class="d-block my-3">
		  <div class="custom-control custom-radio">
			<input id="cashOnDelivery" name="cashOnDelivery" type="radio" class="custom-control-input" checked="" >
			<label class="custom-control-label" for="cashOnDelivery">Cash on Delivery</label>
		  </div>
		</div>
	  
		<hr class="mb-4">
		<button class="btn btn-primary btn-lg btn-block" type="submit" name="submit" value="submit">Continue to checkout</button>
	  </form>
	</div>
  </div>
<?php include('layouts/footer.php'); ?>



<?php
include 'header.php';
include 'connection.php';

?>
<div class="row mt-2">
        

        <div class="col-md-12 order-md-3">
          <h4 class="mb-3">Billing address</h4>
          <?php 
            if(isset($errorMsg) && count($errorMsg) > 0)
            {
                foreach($errorMsg as $error)
                {
                    echo '<div class="alert alert-danger">'.$error.'</div>';
                }
            }
          ?>
          <form class="needs-validation" method="POST">
            <div class="row">
              <div class="col-md-6 mb-3">
                <label for="firstName">First name</label>
                <input type="text" class="form-control" id="firstName" name="first_name" placeholder="First Name" value="<?php echo (isset($first_name) && !empty($first_name)) ? $first_name:'' ?>" >
              </div>
              <div class="col-md-6 mb-3">
                <label for="lastName">Last name</label>
                <input type="text" class="form-control" id="lastName" name="last_name" placeholder="Last Name" value="<?php echo (isset($last_name) && !empty($last_name)) ? $last_name:'' ?>" >
              </div>
            </div>
 
            <div class="mb-3">
              <label for="email">Email</label>
              <input type="email" class="form-control" id="email" name="email" placeholder="you@example.com" value="<?php echo (isset($email) && !empty($email)) ? $email:'' ?>">
            </div>
 
            <div class="mb-3">
              <label for="address">Address</label>
              <input type="text" class="form-control" id="address" name="address1" placeholder="1234 Main St" value="<?php echo (isset($address1) && !empty($address1)) ? $address1:'' ?>">
            </div>

            <div class="mb-3">
              <label for="address2">Address 2 <span class="text-muted">(Optional)</span></label>
              <input type="text" class="form-control" id="address2" name="address2" placeholder="Apartment or suite" value="<?php echo (isset($address2) && !empty($address2)) ? $address2:'' ?>">
            </div>
 
            <div class="row">
              <div class="col-md-5 mb-3">
                <label for="country">Country</label>
                <select class="custom-select d-block w-100" name="country" id="country" >
                  <option value="">Choose...</option>
                  <option value="United States" >United States</option>
                  <option value="United States" >Myanmar</option>
                  <option value="United States" >Thailand</option>
                  <option value="United States" >Korea</option>
                  <option value="United States" >Japan</option>
                </select>
              </div>
              
              <div class="col-md-3 mb-3">
                <label for="zip">Zip</label>
                <input type="text" class="form-control" id="zip" name="zipcode" placeholder="" value="<?php echo (isset($zipCode) && !empty($zipCode)) ? $zipCode:'' ?>" >
              </div>
            </div>
            <hr class="mb-4">
 
            <h4 class="mb-3">Payment</h4>
            
            Enter  Name : <input type="text" name="cname"><br><br>
            Enter Card Number : <input type="text" name="cardnumber"><br>
           
            <hr class="mb-4" >
            <button class="btn btn-info btn btn-secondary btn-lg"  type="submit" name="submit" value="submit">Complete Checkout</button>
          </form>
        </div>
      </div>

      <div class="container p-0"></div><br>
  <!-- Grid container -->
  
  </div>

  <?php 
   
    if(isset($_SESSION['submit']) )
    try {
    include 'connection.php';
        
    $sql="INSERT INTO orders(first_name, last_name, email, address1, address2, country, zipcode, cname, cardnumber  ) VALUES(?,?,?,?,?,?,?,?,?)";
    $sq= $db->prepare($sql);    
    $first_name= $_POST['first_name'];
    $last_name= $_POST['last_name'];
    $email= $_POST['email'];
    $address1= $_POST['address'];
    $address2= $_POST['address2'];
    $country= $_POST['country'];
    $zipcode= $_POST['zipcode'];
    $cname= $_POST['cname'];
    $cardnumber= $_POST['cardnumber'];
    
    if($sq->execute(array($first_name, $last_name, $email, $address1, $address2, $country,  $zipcode, $cname, $cardnumber))){        
    }
    else echo "FAILED";
} catch (PDOException $e) {
    echo $e->getMessage();
}
 
?>

